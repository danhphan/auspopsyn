---

title: synpop_explore


keywords: fastai
sidebar: home_sidebar

summary: "API details."
description: "API details."
nb_path: "01_synpop_explore.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 01_synpop_explore.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">synthpop.categorizer</span> <span class="k">as</span> <span class="nn">cat</span>
<span class="kn">import</span> <span class="nn">multiprocessing</span>
<span class="kn">import</span> <span class="nn">synthpop.zone_synthesizer</span> <span class="k">as</span> <span class="nn">zs</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">synthpop.synthesizer</span> <span class="kn">import</span> <span class="n">synthesize</span><span class="p">,</span> <span class="n">enable_logging</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Load-sample-and-marginal-distribution-data">Load sample and marginal distribution data<a class="anchor-link" href="#Load-sample-and-marginal-distribution-data"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hh_marginal_file</span> <span class="o">=</span> <span class="s1">&#39;data/example/hh_marginals.csv&#39;</span>
<span class="n">person_marginal_file</span> <span class="o">=</span> <span class="s1">&#39;data/example/person_marginals.csv&#39;</span>
<span class="n">hh_sample_file</span> <span class="o">=</span> <span class="s1">&#39;data/example/household_sample.csv&#39;</span>
<span class="n">person_sample_file</span> <span class="o">=</span> <span class="s1">&#39;data/example/person_sample.csv&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hh_marg</span><span class="p">,</span> <span class="n">p_marg</span><span class="p">,</span> <span class="n">hh_sample</span><span class="p">,</span> <span class="n">p_sample</span><span class="p">,</span> <span class="n">xwalk</span> <span class="o">=</span> <span class="n">zs</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">hh_marginal_file</span><span class="p">,</span> <span class="n">person_marginal_file</span><span class="p">,</span> <span class="n">hh_sample_file</span><span class="p">,</span> <span class="n">person_sample_file</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hh_marg</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">p_marg</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">hh_sample</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">p_sample</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((21, 11), (21, 10), (3149, 10), (7924, 8))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hh_sample</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>serialno</th>
      <th>sample_geog</th>
      <th>cars</th>
      <th>workers</th>
      <th>children</th>
      <th>income</th>
      <th>VEH</th>
      <th>FINCP</th>
      <th>NOC</th>
      <th>WIF</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2012000013083</td>
      <td>1</td>
      <td>two or more</td>
      <td>none</td>
      <td>no</td>
      <td>lt35</td>
      <td>3</td>
      <td>11400.0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2012000023543</td>
      <td>1</td>
      <td>two or more</td>
      <td>none</td>
      <td>no</td>
      <td>lt35</td>
      <td>2</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2012000058856</td>
      <td>1</td>
      <td>two or more</td>
      <td>none</td>
      <td>no</td>
      <td>lt35</td>
      <td>2</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2012000062123</td>
      <td>1</td>
      <td>two or more</td>
      <td>none</td>
      <td>no</td>
      <td>lt35</td>
      <td>3</td>
      <td>30300.0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2012000066729</td>
      <td>1</td>
      <td>two or more</td>
      <td>none</td>
      <td>no</td>
      <td>lt35</td>
      <td>2</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p_sample</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>serialno</th>
      <th>sample_geog</th>
      <th>age</th>
      <th>race</th>
      <th>sex</th>
      <th>AGEP</th>
      <th>SEX</th>
      <th>RAC1P</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2012000005576</td>
      <td>1</td>
      <td>20 to 35</td>
      <td>white</td>
      <td>male</td>
      <td>27</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2012000017760</td>
      <td>1</td>
      <td>20 to 35</td>
      <td>white</td>
      <td>male</td>
      <td>34</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2012000021787</td>
      <td>1</td>
      <td>20 to 35</td>
      <td>white</td>
      <td>male</td>
      <td>32</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2012000021815</td>
      <td>1</td>
      <td>20 to 35</td>
      <td>white</td>
      <td>male</td>
      <td>23</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2012000065237</td>
      <td>1</td>
      <td>20 to 35</td>
      <td>white</td>
      <td>male</td>
      <td>24</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hh_marg</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th>zone_id</th>
      <th colspan="3" halign="left">cars</th>
      <th colspan="2" halign="left">children</th>
      <th colspan="3" halign="left">income</th>
      <th colspan="3" halign="left">workers</th>
    </tr>
    <tr>
      <th></th>
      <th>none</th>
      <th>one</th>
      <th>two or more</th>
      <th>no</th>
      <th>yes</th>
      <th>gt100</th>
      <th>gt35-lt100</th>
      <th>lt35</th>
      <th>none</th>
      <th>one</th>
      <th>two or more</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>7</td>
      <td>49</td>
      <td>197</td>
      <td>41</td>
      <td>215</td>
      <td>57</td>
      <td>125</td>
      <td>74</td>
      <td>72</td>
      <td>77</td>
      <td>105</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9</td>
      <td>59</td>
      <td>237</td>
      <td>68</td>
      <td>239</td>
      <td>83</td>
      <td>126</td>
      <td>98</td>
      <td>87</td>
      <td>93</td>
      <td>125</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10</td>
      <td>69</td>
      <td>275</td>
      <td>79</td>
      <td>279</td>
      <td>74</td>
      <td>170</td>
      <td>114</td>
      <td>102</td>
      <td>108</td>
      <td>146</td>
    </tr>
    <tr>
      <th>4</th>
      <td>11</td>
      <td>76</td>
      <td>302</td>
      <td>167</td>
      <td>224</td>
      <td>42</td>
      <td>105</td>
      <td>244</td>
      <td>111</td>
      <td>118</td>
      <td>160</td>
    </tr>
    <tr>
      <th>5</th>
      <td>18</td>
      <td>117</td>
      <td>466</td>
      <td>86</td>
      <td>517</td>
      <td>50</td>
      <td>261</td>
      <td>292</td>
      <td>171</td>
      <td>182</td>
      <td>247</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p_marg</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th>zone_id</th>
      <th colspan="4" halign="left">age</th>
      <th colspan="4" halign="left">race</th>
      <th colspan="2" halign="left">sex</th>
    </tr>
    <tr>
      <th></th>
      <th>19 and under</th>
      <th>20 to 35</th>
      <th>35 to 60</th>
      <th>above 60</th>
      <th>asian</th>
      <th>black</th>
      <th>other</th>
      <th>white</th>
      <th>female</th>
      <th>male</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>312</td>
      <td>108</td>
      <td>223</td>
      <td>177</td>
      <td>64</td>
      <td>0</td>
      <td>0</td>
      <td>756</td>
      <td>440</td>
      <td>380</td>
    </tr>
    <tr>
      <th>2</th>
      <td>235</td>
      <td>143</td>
      <td>296</td>
      <td>181</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>855</td>
      <td>452</td>
      <td>403</td>
    </tr>
    <tr>
      <th>3</th>
      <td>303</td>
      <td>229</td>
      <td>445</td>
      <td>174</td>
      <td>0</td>
      <td>0</td>
      <td>24</td>
      <td>1127</td>
      <td>565</td>
      <td>586</td>
    </tr>
    <tr>
      <th>4</th>
      <td>215</td>
      <td>77</td>
      <td>356</td>
      <td>189</td>
      <td>0</td>
      <td>0</td>
      <td>29</td>
      <td>808</td>
      <td>389</td>
      <td>448</td>
    </tr>
    <tr>
      <th>5</th>
      <td>506</td>
      <td>539</td>
      <td>619</td>
      <td>262</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1926</td>
      <td>981</td>
      <td>945</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Synthesize-all-zones">Synthesize all zones<a class="anchor-link" href="#Synthesize-all-zones"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hh_all</span><span class="p">,</span> <span class="n">p_all</span><span class="p">,</span> <span class="n">stats</span> <span class="o">=</span> <span class="n">zs</span><span class="o">.</span><span class="n">synthesize_all_zones</span><span class="p">(</span><span class="n">hh_marg</span><span class="p">,</span> <span class="n">p_marg</span><span class="p">,</span> <span class="n">hh_sample</span><span class="p">,</span> <span class="n">p_sample</span><span class="p">,</span> <span class="n">xwalk</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/danph/Repos/win_ssd/tutorials/urban_ds/synthpop/synthpop/ipu/ipu.py:193: RuntimeWarning: divide by zero encountered in double_scalars
  adj = constraint / float((column * weights).sum())
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Drawing 254 households
Drawing 306 households
Drawing 356 households
Drawing 390 households
Drawing 601 households
Drawing 324 households
Drawing 556 households
Drawing 342 households
Drawing 273 households
Drawing 228 households
Drawing 857 households
Drawing 748 households
Drawing 744 households
Drawing 953 households
Drawing 719 households
Drawing 185 households
Drawing 183 households
Drawing 286 households
Drawing 317 households
Drawing 711 households
Drawing 345 households
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hh_all</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">p_all</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((9678, 12), (33921, 11))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hh_all</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>serialno</th>
      <th>sample_geog</th>
      <th>cars</th>
      <th>workers</th>
      <th>children</th>
      <th>income</th>
      <th>VEH</th>
      <th>FINCP</th>
      <th>NOC</th>
      <th>WIF</th>
      <th>cat_id</th>
      <th>geog</th>
    </tr>
    <tr>
      <th>household_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2013000688302</td>
      <td>1</td>
      <td>none</td>
      <td>none</td>
      <td>no</td>
      <td>lt35</td>
      <td>0</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
      <td>6</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2010000141368</td>
      <td>1</td>
      <td>none</td>
      <td>none</td>
      <td>yes</td>
      <td>lt35</td>
      <td>0</td>
      <td>3500.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>15</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2012001476110</td>
      <td>1</td>
      <td>none</td>
      <td>none</td>
      <td>yes</td>
      <td>lt35</td>
      <td>0</td>
      <td>3100.0</td>
      <td>3</td>
      <td>0.0</td>
      <td>15</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2010000262947</td>
      <td>1</td>
      <td>none</td>
      <td>none</td>
      <td>yes</td>
      <td>lt35</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>15</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2010000141368</td>
      <td>1</td>
      <td>none</td>
      <td>none</td>
      <td>yes</td>
      <td>lt35</td>
      <td>0</td>
      <td>3500.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>15</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p_all</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>serialno</th>
      <th>sample_geog</th>
      <th>age</th>
      <th>race</th>
      <th>sex</th>
      <th>AGEP</th>
      <th>SEX</th>
      <th>RAC1P</th>
      <th>cat_id</th>
      <th>geog</th>
      <th>household_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2012000522864</td>
      <td>1</td>
      <td>20 to 35</td>
      <td>white</td>
      <td>male</td>
      <td>27</td>
      <td>1</td>
      <td>1</td>
      <td>69</td>
      <td>1</td>
      <td>189</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2012000522864</td>
      <td>1</td>
      <td>20 to 35</td>
      <td>white</td>
      <td>female</td>
      <td>26</td>
      <td>2</td>
      <td>1</td>
      <td>68</td>
      <td>1</td>
      <td>189</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2012000522864</td>
      <td>1</td>
      <td>19 and under</td>
      <td>white</td>
      <td>female</td>
      <td>5</td>
      <td>2</td>
      <td>1</td>
      <td>60</td>
      <td>1</td>
      <td>189</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2012000522864</td>
      <td>1</td>
      <td>19 and under</td>
      <td>white</td>
      <td>female</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>60</td>
      <td>1</td>
      <td>189</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2012000737274</td>
      <td>1</td>
      <td>20 to 35</td>
      <td>white</td>
      <td>male</td>
      <td>27</td>
      <td>1</td>
      <td>1</td>
      <td>69</td>
      <td>1</td>
      <td>86</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

